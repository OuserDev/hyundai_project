---
- name: 파일 및 디렉토리 관리 - 패스워드 파일 보호
  hosts: local
  become: yes

  tasks:
    - name: "/etc/passwd 파일 소유자 및 권한 설정 (소유자: root, 권한: 644)"
      # /etc/passwd 파일은 사용자 계정 정보를 담고 있으며, 일반 사용자에 의한 변경을 방지하기 위해 권한을 제한합니다.
      # 진단 기준: 양호 - 소유자 root, 권한 644 이하.
      # 조치 방법: 소유자 root, 권한 644로 설정.
      ansible.builtin.file:
        path: "/etc/passwd"
        owner: root
        group: root
        mode: '0644' # 'rw-r--r--'
        state: file

    - name: "/etc/shadow 파일 소유자 및 권한 설정 (소유자: root, 권한: 400)"
      # /etc/shadow 파일은 암호화된 사용자 패스워드를 담고 있으며, root만 읽을 수 있도록 가장 엄격하게 권한을 제한합니다.
      # 이 파일은 민감한 정보를 포함하므로, 접근 권한을 최소화하는 것이 중요합니다.
      # 가이드에 명시된 특정 기준이 없으므로, 일반적으로 권장되는 가장 엄격한 권한(root만 읽기 가능)을 적용합니다.
      ansible.builtin.file:
        path: "/etc/shadow"
        owner: root
        group: root # 일반적으로 root 또는 shadow 그룹을 사용하지만, 가장 엄격한 접근을 위해 root:root로 설정합니다.
        mode: '0400' # 'r--------' (root만 읽기 가능, 다른 사용자/그룹 접근 불가)
        state: file
